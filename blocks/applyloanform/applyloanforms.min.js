import{applyLoanInteraction as X,applyLoanNow as $,ctaClick as Z,formInteraction as x,talkToExpert as H}from"../../dl.min.js";import{targetObject as c}from"../../scripts/scripts.min.js";import{branchInput as ee,cutomerIncome as te,cutomerName as oe,cutomerNo as j,formDobInput as ne,formLoanAmt as re,formTc as ae,loanOtpInput as v,loanProduct as G,otpNumChange as le,otpPhoneNum as ce,stateInput as J}from"./loanformdom.min.js";import{statemasterGetStatesApi as se}from"./statemasterapi.min.js";import{loanTypeDropdownSelect as ie}from"./utm.min.js";import{validationJSFunc as me}from"./validation.min.js";export let overlay,emiOverlay,elgOverlay,loaninnerform,bodyElement;export function handleOpenFormOnClick(n){n.querySelectorAll(".open-form-on-click .button-container").forEach(s=>{console.log(s),s.addEventListener("click",de)})}function de(n){se(),me(),formOpen();try{if(!n.target.closest(".section").classList.contains("banner-carousel-wrapper")&&!n.target.closest(".section").classList.contains("documents-required-brown")){const r={};r.click_text=n.target.textContent.trim(),X(r)}if(n.target.closest(".section").classList.contains("documents-required-brown")){const r=n.target.textContent.trim(),s=n.target.closest(".section").querySelector(".default-content-wrapper").querySelector("h1, h2, h3, h4, h5, h6").textContent.trim();Z(r,s,"",c.pageName)}}catch(r){console.warn(r)}n.preventDefault()}export function createOverlay(n){const r=document.createElement("div");return r.classList.add("overlay"),r.style.zIndex=1209,{hide(){n.querySelector(".overlay").remove()},show(){n.append(r)}}}export let formOverlay={};export function applyLoanFormClick(){loaninnerform=document.querySelector(".loan-form-sub-parent"),loaninnerform=document.querySelector(".loan-form-sub-parent");const n=document.querySelector(".homeloancalculator.block")||document.createElement("div");if(formOverlay=createOverlay(n),loaninnerform){let F=function(e){e.style.display==="block"?e.style.display="none":e.style.display="block"},h=function(e){window.getComputedStyle(e).getPropertyValue("visibility")==="hidden"?e.style.visibility="visible":e.style.visibility="hidden"},i=function(e){e.classList.toggle("inverted")},R=function(e){if((e.target.closest("#statecontainer")&&e.target.classList.contains("subpoints")||m&&!E.contains(e.target)&&!y.contains(e.target))&&(h(y),i(E.querySelector(".arrowimage")),loaninnerform.querySelector("#statecontainer").style.visibility="hidden",m=!1),(e.target.closest("#branchcontainer")&&e.target.classList.contains("subpoints")||d&&!k.contains(e.target)&&!p.contains(e.target))&&(h(p),i(k.querySelector(".arrowimage")),loaninnerform.querySelector("#branchcontainer").style.visibility="hidden",d=!1),e.target.closest(".cmp-form-text")&&e.target.classList.contains("subpoints")||g&&!b.contains(e.target)&&!Q.contains(e.target)){const t=b.nextElementSibling;F(t),i(this.querySelector(".arrowimage")),g=!1}},f=function(){document.querySelector(".applyloanform").querySelectorAll(".loan-form-err").forEach(l=>{l.style.display="none"}),[G(),re(),oe(),te(),ne(),J(),ee(),j()].forEach(l=>l.value=""),ae().checked=!1,document.querySelector("#radio-salary").checked=!0,document.querySelectorAll(".loan-form-button-container .cmp-container").forEach(l=>{l.classList.remove("loan-form-button-active")})},z=function(e,t){clearInterval(t),clearInterval(u);const o=document.querySelector("#loan-form-resend-otp");u=setInterval(()=>{e>=0?(document.querySelector(".applyloanform .timer").style.display="block",e<=9?document.querySelector(".applyloanform .timer").innerHTML=`00:0${e}`:document.querySelector(".applyloanform .timer").innerHTML=`00:${e}`,e--,o.style.pointerEvents="none"):(clearInterval(t),document.querySelector(".applyloanform .timer").style.display="none",o.style.pointerEvents="unset")},1e3)};const r=document.querySelectorAll(".cmp-form-option-parent");r[0].style.border="1px solid #f26841",r.forEach(e=>{e.addEventListener("click",function(){const t=this.querySelector('input[type="radio"]');t.checked=!0,r.forEach(o=>{o.style.border="1px solid #AFB9C3"}),e.style.border="1px solid #f26841"})});const s=document.querySelectorAll(".crossimage, .failformcross"),I=document.querySelectorAll(".expert");overlay=document.querySelector(".modal-overlay");const L=document.querySelector(".first-form-button .cmp-container");bodyElement=document.body;const ue=document.querySelector(".loan-form-otp-button-container .cmp-container"),W=document.querySelector(".leftarrow"),C=document.querySelector(".cmp-container--documentrequired .cmp-container .extendedbutton"),A=document.querySelector("#loan-banner .cmp-teaser__content .cmp-teaser__action-container .cmp-teaser__action-link"),B=document.getElementById("sticky-btn-loan-form"),N=document.querySelectorAll(".cmp-container--branches .cmp-contentfragmentlist .cmp-contentfragment .cmp-contentfragment__elements .cmp-contentfragment__element--ctaName .cmp-contentfragment__element-value"),O=document.querySelectorAll(".cmp-teaser--open-form-action .cmp-teaser .cmp-teaser__action-container .cmp-teaser__action-link"),_=document.querySelectorAll(".open-form-btn"),w=document.querySelector(".location-link");I.forEach(e=>{e.addEventListener("click",t=>{t.preventDefault();const o=e.closest("a");if(o&&o.getAttribute("href")){try{const q=t.target?.closest(".section")?.querySelector(".tab-common.active p")?.textContent.trim(),V=t.target?.closest(".section")?.querySelector(".calculator-parent p")?.textContent.trim();t.target.innerText.trim()==="Talk to loan expert"?H("calculator",q,V,c.pageName):t.target.innerText.trim()==="Apply loan now"&&$("calculator",q,V,c.pageName)}catch(q){console.warn(q)}const a=o.getAttribute("href"),l=o.getAttribute("target");l==="_blank"?window.open(a,l):window.location.href=a}else{formOpen(),f(),L.classList.remove("loader-initialized"),loaninnerform.classList.remove("loan-form-sub-otp","loan-form-success","loan-form-request-fail","loan-form-something-wrong");try{const a=t.target?.closest(".section")?.querySelector(".tab-common.active p")?.textContent.trim(),l=t.target?.closest(".section")?.querySelector(".calculator-parent p")?.textContent.trim();t.target.innerText.trim()==="Talk to loan expert"?(H("calculator",a,l,c.pageName),x(a,"Form Open",c.pageName)):t.target.innerText.trim()==="Apply loan now"&&($("calculator",a,l,c.pageName),x(c.pageName,"Form Open",c.pageName))}catch(a){console.warn(a)}}loaninnerform.querySelector("#statecontainer").style.visibility="hidden",loaninnerform.querySelector("#branchcontainer").style.visibility="hidden"})}),C&&C.addEventListener("click",e=>{e.preventDefault(),formOpen()}),O&&O.forEach(e=>{e.addEventListener("click",()=>{formOpen()})}),_&&_.forEach(e=>{e.addEventListener("click",()=>{formOpen()})}),A&&!w&&A.addEventListener("click",e=>{e.preventDefault(),formOpen()}),B&&!w&&B.addEventListener("click",e=>{formOpen()}),N&&!w&&N.forEach(e=>{e.addEventListener("click",t=>{t.preventDefault(),formOpen()})}),ie(),s.forEach(e=>{e.addEventListener("click",t=>{t.stopImmediatePropagation();try{x(c.pageName,"Form Close",c.pageName)}catch(a){console.warn(a)}const o=document.querySelector(".home-page-calculator-call-xf");o?o.querySelector(".homeloancalculator-wrapper .show")||o.querySelector(".eligibilitycalculator-wrapper .show")?(loaninnerform.querySelector("#statecontainer").style.visibility="hidden",loaninnerform.querySelector("#branchcontainer").style.visibility="hidden",loaninnerform.style.visibility="hidden",overlay.style.zIndex="1111",loaninnerform.classList.contains("loan-form-success")&&(loaninnerform.classList.remove("loan-form-success"),loaninnerform.classList.remove("loan-form-sub-otp"))):(loaninnerform.classList.remove("loan-form--open"),document.querySelector(".modal-overlay").classList.remove("overlay"),document.querySelector(".modal-overlay").classList.add("dp-none"),loaninnerform.querySelector("#statecontainer").style.visibility="hidden",loaninnerform.querySelector("#branchcontainer").style.visibility="hidden",bodyElement.style.overflowY="auto",loaninnerform.style.visibility="hidden",f(),loaninnerform.classList.remove("loan-form-sub-otp","loan-form-success","loan-form-request-fail","loan-form-something-wrong"),loaninnerform.classList.contains("loan-form-success")&&(loaninnerform.classList.remove("loan-form-success"),loaninnerform.classList.remove("loan-form-sub-otp"))):(loaninnerform.classList.remove("loan-form--open"),document.querySelector(".modal-overlay").classList.remove("overlay"),document.querySelector(".modal-overlay").classList.add("dp-none"),loaninnerform.querySelector("#statecontainer").style.visibility="hidden",loaninnerform.querySelector("#branchcontainer").style.visibility="hidden",bodyElement.style.overflowY="auto",loaninnerform.style.visibility="hidden",loaninnerform.classList.contains("loan-form-success")&&(loaninnerform.classList.remove("loan-form-success"),loaninnerform.classList.remove("loan-form-sub-otp"))),f(),loaninnerform.classList.remove("loan-form-sub-otp","loan-form-success","loan-form-request-fail","loan-form-something-wrong")})}),L&&L.addEventListener("click",()=>{loaninnerform.classList.add("loan-form-sub-otp"),ce().textContent=j().value,document.querySelector(".wrongotpmessage").style.display="none",z(Y,M);const e=document.querySelector(".applyloanform .timer");e&&(e.style.display="block"),v().value="",document.querySelector("#otp-digits").textContent="0/4 Digits"});const T=document.querySelector("#loan-form-resend-otp");T&&T.addEventListener("click",()=>{z(Y,M)}),W.addEventListener("click",e=>{loaninnerform.classList.remove("loan-form-sub-otp"),document.querySelector(".wrongotpmessage").style.display="none",clearInterval(u),v().value=""});const K=document.querySelector(".loan-form-sub-parent .cmp-container");emiOverlay=document.querySelector(".cmp-container--emicaloverlay"),elgOverlay=document.querySelector(".cmp-container--elgcaloverlay"),loaninnerform.addEventListener("click",e=>{if(e.target.classList.contains("subpoints")){const t=e.target.dataset.getInput,o=document.querySelector(`#${t}`);if(o.value=e.target.textContent.trim(),o.id=="form-loan-type"){const{loanType:a,loanName:l}=e.target.dataset;o.dataset.loanType=a,o.dataset.loanName=l,J().value="",G().dispatchEvent(new Event("change"))}o.id!="form-loan-type"&&(o.dispatchEvent(new Event("change")),o.classList.add("place-selected")),o.dispatchEvent(new Event("input",{bubbles:!0}));return}K.contains(e.target)||(emiOverlay||elgOverlay?emiOverlay.classList.contains("show")||elgOverlay.classList.contains("show")?(loaninnerform.querySelector("#statecontainer").style.visibility="hidden",loaninnerform.querySelector("#branchcontainer").style.visibility="hidden",loaninnerform.style.visibility="hidden",overlay.style.zIndex="1000"):(document.querySelector(".modal-overlay").classList.remove("overlay"),document.querySelector(".modal-overlay").classList.add("dp-none"),loaninnerform.querySelector("#statecontainer").style.visibility="hidden",loaninnerform.querySelector("#branchcontainer").style.visibility="hidden",loaninnerform.style.visibility="hidden",document.body.style.overflowY="auto",f(),clearInterval(u),v().value="",loaninnerform.classList.remove("loan-form-sub-otp","loan-form-success","loan-form-request-fail","loan-form-something-wrong")):(document.querySelector(".modal-overlay").classList.remove("overlay"),document.querySelector(".modal-overlay").classList.add("dp-none"),loaninnerform.querySelector("#statecontainer").style.visibility="hidden",loaninnerform.querySelector("#branchcontainer").style.visibility="hidden",loaninnerform.style.visibility="hidden",document.body.style.overflowY="auto",f(),clearInterval(u),v().value="",loaninnerform.classList.remove("loan-form-sub-otp","loan-form-success","loan-form-request-fail","loan-form-something-wrong")))}),overlay.addEventListener("click",e=>{window.matchMedia("(max-width: 1024px)").matches&&(document.querySelector(".modal-overlay").classList.remove("overlay"),document.querySelector(".modal-overlay").classList.add("dp-none"),loaninnerform.querySelector("#statecontainer").style.visibility="hidden",loaninnerform.querySelector("#branchcontainer").style.visibility="hidden",loaninnerform.style.visibility="hidden",bodyElement.style.overflowY="auto")});const y=document.getElementById("statecontainer"),E=document.getElementById("stateparent"),p=document.getElementById("branchcontainer"),k=document.getElementById("branchparent"),b=document.querySelector(".multiselectoptions"),Q=b.nextElementSibling;let m=!1,d=!1,g=!1;document.addEventListener("click",R);const D=document.querySelector("#branchparent .arrowimage");E.addEventListener("click",function(e){p.style.visibility="hidden",D.classList.remove("inverted"),d=!1,h(y),i(this.querySelector(".arrowimage")),m=!m,e.stopPropagation()});const P=document.querySelector("#stateparent .arrowimage");k.addEventListener("click",function(e){y.style.visibility="hidden",P.classList.remove("inverted"),m=!1,h(p),i(this.querySelector(".arrowimage")),d=!d,e.stopPropagation()}),b.addEventListener("click",function(e){p.style.visibility="hidden",D.classList.remove("inverted"),d=!1,y.style.visibility="hidden",P.classList.remove("inverted"),m=!1;const t=this.nextElementSibling;F(t),i(this.querySelector(".arrowimage")),g=!g,e.stopPropagation()});const U=document.getElementById("loanformcheck"),S=document.querySelector(".circle");U.addEventListener("change",function(){this.checked?(S.classList.add("movecircle"),S.classList.remove("animate")):(S.classList.remove("movecircle"),S.classList.add("animate"))});let Y=30,M,u;le().addEventListener("click",()=>{document.querySelector(".loan-form-sub-parent").classList.remove("loan-form-sub-otp"),document.querySelector(".wrongotpmessage").style.display="none",clearInterval(u),v().value=""})}}export function formOpen(){if(window.matchMedia("(max-width: 1024px)").matches)document.querySelector(".modal-overlay").classList.add("overlay"),document.querySelector(".modal-overlay").classList.remove("dp-none"),loaninnerform.classList.add("loan-form--open"),loaninnerform.style.visibility="visible",bodyElement.style.overflowY="hidden";else{document.querySelector(".modal-overlay").classList.add("overlay"),document.querySelector(".modal-overlay").classList.remove("dp-none");const n=document.querySelector(".home-page-calculator-call-xf");n&&(n.querySelector(".homeloancalculator-wrapper .show")||n.querySelector(".eligibilitycalculator-wrapper .show"))&&(overlay.style.zIndex="1205"),loaninnerform.style.visibility="visible",bodyElement.style.overflowY="hidden"}}window.addEventListener("pageshow",n=>{n.persisted&&window.location.reload()}),handleOpenFormOnClick(document);
