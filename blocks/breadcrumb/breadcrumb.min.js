import{createElement as x}from"../../scripts/scripts.min.js";import{HOME as H,RIGHTARROW as b}from"../../scripts/constants.min.js";import{getMetadata as f}from"../../scripts/aem.min.js";const E=async e=>{const t=await fetch(e);if(t.ok){const a=document.createElement("div");return a.innerHTML=await t.text(),a.querySelector('[name="page-name"]')?.getAttribute("content")}return""},M=async(e,t)=>{const a=[];let i=t;window.location.host.includes("author")||(i<=4?i=1:i-=3);const s=e.replace(/^\/|\/$/g,"").split("/");let n="";for(let r=0;r<=s.length-2;r+=1){n=`${n}/${s[r]}`;let o=`${window.location.origin}${n}`;if(window.location.host.includes("author")&&(o=`${window.location.origin}${n}.html`),r>=i-1){const m=await E(o);m&&a.push({pathVal:n,name:m,url:o})}}return a},w=e=>{const t=document.createElement("a");return t.href=e.url,e.name!=="HomePage"?t.innerText=e.name:(t.title=e.label,t.innerHTML=H),t};export default async function y(e){const[t,a,i,s,n,r]=e.children,o=t?.textContent.trim()||"false",m=i?.textContent.trim()||"false";let u=a?.textContent.trim()||1;const L=s?.textContent.trim()||"black",g=f("breadcrumblevel"),d=x("nav","",{"aria-label":"Breadcrumb"});if(n.innerText?.trim()&&r.innerText?.trim()){const l=[],T=r.innerText.trim().replace(/~/g,"/").split(",");return n.innerText.trim().split(",").forEach((c,h)=>{l.push(`<a href="${f("lang-path")+T[h]}">${c}</a>`)}),e.innerHTML="",e.classList.add(L),d.innerHTML=l.join(`<span class="breadcrumb-separator">${b}</span>`),e.append(d),e}if(g!==""&&(u=g),e.innerHTML="",e.classList.add(L),o==="true")return;let p=[];u=="hidehome"?u="":p=[w({path:"",name:"HomePage",url:window.location.origin,label:"Home"}).outerHTML],document.addEventListener("load-event",async()=>{const l=window.location.pathname;if((await M(l,u)).forEach(c=>p.push(w(c).outerHTML)),m==="false"){const c=document.createElement("a");c.href=window.location.href;const h=f("page-name");c.innerText=h.replace(" | Pricefx",""),p.push(c.outerHTML)}d.innerHTML=p.join(`<span class="breadcrumb-separator">${b}</span>`),e.append(d)})}function A(e){const t=[],a=document.createElement("div");if(a.innerHTML=e.join(""),Array.from(a.querySelectorAll("a")).some(r=>!!r.getAttribute("href").includes("/branch-locator")))return;a.querySelectorAll("a").forEach((r,o)=>{t.push({"@type":"ListItem",position:o+1,name:r.textContent,item:location.origin+r.getAttribute("href")})});let s={"@context":"https://schema.org","@type":"BreadcrumbList",itemListElement:t};const n=document.createElement("script");n.type="application/ld+json",n.innerHTML=JSON.stringify(s),document.head.append(n)}
