import{ctaClickInteraction as h}from"../../dl.min.js";import{fetchAPI as m,getProps as C,renderHelper as S}from"../../scripts/common.min.js";export default async function v(n){const i=C(n),[c,d]=i;n.innerHTML="";try{let g=function(t){n.querySelectorAll(".subAccordianBox").forEach(e=>{t.target.parentElement.classList.contains("active")||(e.classList.remove("active"),e.querySelectorAll(".subAccordianContent,.grey-border").forEach(r=>{r.style.display="none"}))});const a=t.target.parentNode,l=getSiblings(a);a.classList.toggle("active"),l.forEach(e=>{e.classList.remove("active")}),a.querySelectorAll(".subAccordianContent").forEach(e=>{const r=window.getComputedStyle(e);e.parentElement.style.display=r.getPropertyValue("display")==="none"?"block":"none",e.style.display=r.getPropertyValue("display")==="none"?"block":"none"}),l.forEach(e=>{const r=e.querySelector(".subAccordianContent");window.getComputedStyle(r).getPropertyValue("display")==="block"&&(r.style.display="none")});try{const e={};e.click_text=t.target.textContent.trim(),e.cta_position=t.target.closest(".section").querySelector(".default-content-wrapper").querySelector("h1, h2, h3, h4, h5, h6").textContent.trim(),h(e)}catch(e){console.warn(e)}};const s=(await(await m("GET",c)).json()).result[0];let y;d==="ascending"?y=Object.keys(s).sort((t,a)=>t-a):y=Object.keys(s).sort((t,a)=>a-t);const u=["January","February","March","April","May","June","July","August","September","October","November","December"];y.forEach(t=>{const a=s[t][0];let l;d==="ascending"?l=Object.keys(a).sort((e,r)=>u.indexOf(e)-u.indexOf(r)):l=Object.keys(a).sort((e,r)=>u.indexOf(r)-u.indexOf(e));let f="";l.forEach(e=>{const r=a[e].sort((b,A)=>new Date(A.pdfDate)-new Date(b.pdfDate));f+=`  
                                <div class="subAccordianContent" style="display: nona;">
                                    <div class="publicDisclosuresWrap">
                                        <div class="innersubAccordianContent">
                                            <a href="javascript:;" class="innersubAccordianTitle">${e}</a>
                                            <div class="publicDisclosuresWrap innerSubAccordianData" style="display: none;" >
                                                <ul> ${S(r,`
                                                    <div class="forName">    
                                                        <li data-date="{pdfDate}">
                                                            <a href="{PdfPath}" data-category="{Pdf_Category}" target="_blank">
                                                                <span class="created-date">{Created_Date}</span>
                                                                {Title}</a>
                                                        </li>
                                                    </div>
                                                    `)} 
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            `}),n.innerHTML+=`
                        <section class="accordianpdf-section">
                            <div class="container boxContainer">
                                <div class="accordianContent">
                                    <div class="accordianBox">
                                        <div class="subAccordianWrap">
                                            <div class="subAccordianBox">
                                                <a href="javascript:;" class="subAccordianTitle"
                                                    data-accordianpdf-folderpath="/content/dam/piramalfinance/pdf/stakeholder/financial-reports/2024"
                                                    data-accordianpdf-folderdepth="2">${t}</a>
                                                    <div class="grey-border" style="display: none;">
                                                ${f}
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </section>
                    `}),n.querySelectorAll(".subAccordianContent").forEach(t=>{t.style.display="none"}),n.querySelectorAll(".subAccordianTitle").forEach(t=>{t.addEventListener("click",g)}),n.querySelectorAll(".innersubAccordianTitle").forEach(t=>{t.addEventListener("click",handleInnerAccordionClick)})}catch(p){console.error(p)}}export function handleInnerAccordionClick(n){const i=n.target.parentNode;i.closest(".grey-border").querySelectorAll(".subAccordianContent").forEach(o=>{n.target.closest(".subAccordianContent")===o||(o.querySelectorAll(".innersubAccordianContent").forEach(s=>{s.classList.remove("active")}),o.querySelectorAll(".innerSubAccordianData").forEach(s=>{s.style.display="none"}))});const c=getSiblings(i);i.classList.toggle("active"),c.forEach(o=>{o.classList.remove("active")});const d=i.querySelector(".innerSubAccordianData"),p=window.getComputedStyle(d);d.style.display=p.getPropertyValue("display")==="none"?"block":"none",c.forEach(o=>{const s=o.querySelector(".innerSubAccordianData");window.getComputedStyle(s).getPropertyValue("display")==="block"&&(s.style.display="none")});try{const o={};o.click_text=n.target.textContent.trim(),o.cta_position=n.target.closest(".section").querySelector(".default-content-wrapper").querySelector("h1, h2, h3, h4, h5, h6").textContent.trim(),h(o)}catch(o){console.warn(o)}}export function getSiblings(n){const i=[];let c=n.parentNode.firstChild;for(;c;c=c.nextSibling)c.nodeType===1&&c!==n&&i.push(c);return i}
