/*! Generic Calculator Block - Minified JS */
class GenericCalculator{constructor(e){this.block=e,this.config=this.loadConfig(),this.init()}loadConfig(){return{maindivbackground:this.block.dataset.maindivbackground||"calculator",title:this.block.dataset.title||"",subheading:this.block.dataset.subheading||"",employmentTypes:{salaried:{enabled:"true"===this.block.dataset.salariedEnabled,label:this.block.dataset.salariedLabel||"I'm Salaried",icon:this.block.dataset.salariedIcon||"",iconAlt:this.block.dataset.salariedIconAlt||""},business:{enabled:"true"===this.block.dataset.businessEnabled,label:this.block.dataset.businessLabel||"I'm doing Business",icon:this.block.dataset.businessIcon||"",iconAlt:this.block.dataset.businessIconAlt||""}},calculators:{emi:{enabled:"true"===this.block.dataset.emiEnabled,label:this.block.dataset.emiLabel||"EMI Calculator",fields:this.parseEMIConfig()},eligibility:{enabled:"true"===this.block.dataset.eligibilityEnabled,label:this.block.dataset.eligibilityLabel||"Eligibility Calculator",fields:this.parseEligibilityConfig()}},results:{emiImage:this.block.dataset.emiResultImage||"",emiImageMobile:this.block.dataset.emiResultImageMobile||"",eligImage:this.block.dataset.eligResultImage||"",eligImageMobile:this.block.dataset.eligResultImageMobile||""},buttons:{button1:{text:this.block.dataset.button1Text||"Talk to loan expert",link:this.block.dataset.button1Link||""},button2:{text:this.block.dataset.button2Text||"Apply loan now",link:this.block.dataset.button2Link||""}}}}parseEMIConfig(){return{loanAmount:{min:parseInt(this.block.dataset.emiLoanMin)||500e3,max:parseInt(this.block.dataset.emiLoanMax)||5e7,step:parseInt(this.block.dataset.emiLoanStep)||1e4,default:parseInt(this.block.dataset.emiLoanDefault)||25e5,label:"Loan amount (Rs.)",suffix:"₹"},tenure:{min:parseInt(this.block.dataset.emiTenureMin)||5,max:parseInt(this.block.dataset.emiTenureMax)||30,step:parseInt(this.block.dataset.emiTenureStep)||1,default:parseInt(this.block.dataset.emiTenureDefault)||10,label:"Loan Tenure (Years)",suffix:"Years"},rate:{min:parseFloat(this.block.dataset.emiRateMin)||10.5,max:parseFloat(this.block.dataset.emiRateMax)||20,step:parseFloat(this.block.dataset.emiRateStep)||.1,default:parseFloat(this.block.dataset.emiRateDefault)||11,label:"Interest Rate (% p.a)",suffix:"%"}}}parseEligibilityConfig(){return{income:{min:parseInt(this.block.dataset.eligIncomeMin)||2e4,max:parseInt(this.block.dataset.eligIncomeMax)||1e6,step:parseInt(this.block.dataset.eligIncomeStep)||1e4,default:parseInt(this.block.dataset.eligIncomeDefault)||1e5,label:"Gross Monthly Income (Rs.)",suffix:"₹"},otherLoanEMI:{min:parseInt(this.block.dataset.eligOtherEMIMin)||0,max:parseInt(this.block.dataset.eligOtherEMIMax)||500e3,step:parseInt(this.block.dataset.eligOtherEMIStep)||5e3,default:parseInt(this.block.dataset.eligOtherEMIDefault)||0,label:"Other Loan EMIs (Rs.)",suffix:"₹"},rate:{min:parseFloat(this.block.dataset.eligRateMin)||10.5,max:parseFloat(this.block.dataset.eligRateMax)||20,step:parseFloat(this.block.dataset.eligRateStep)||.1,default:parseFloat(this.block.dataset.eligRateDefault)||10.5,label:"Interest Rate (% p.a)",suffix:"%"},tenure:{min:parseInt(this.block.dataset.eligTenureMin)||5,max:parseInt(this.block.dataset.eligTenureMax)||30,step:parseInt(this.block.dataset.eligTenureStep)||1,default:parseInt(this.block.dataset.eligTenureDefault)||10,label:"Loan Tenure (Years)",suffix:"Years"}}}init(){this.render(),this.attachEventListeners()}render(){this.block.classList.add("generic-calculator",this.config.maindivbackground);this.block.innerHTML=`<div class="calculator-wrapper">${this.renderHeader()}${this.renderEmploymentSelection()}${this.renderCalculatorTabs()}</div>`}renderHeader(){if(!this.config.title&&!this.config.subheading)return"";return`<div class="calculator-header">${this.config.title?`<h2 class="calculator-title">${this.config.title}</h2>`:""}${this.config.subheading?`<p class="calculator-subheading">${this.config.subheading}</p>`:""}</div>`}renderEmploymentSelection(){const{salaried:e,business:t}=this.config.employmentTypes;if(!e.enabled&&!t.enabled)return"";let i="<div class='employment-selection'>";return e.enabled&&(i+=`<button class="employment-tab salaried-tab" data-type="salaried">${e.icon?`<img src="${e.icon}" alt="${e.iconAlt}" class="employment-icon">`:""}}<span>${e.label}</span></button>`),t.enabled&&(i+=`<button class="employment-tab business-tab" data-type="business">${t.icon?`<img src="${t.icon}" alt="${t.iconAlt}" class="employment-icon">`:""}}<span>${t.label}</span></button>`),i+"</div>"}renderCalculatorTabs(){const{emi:e,eligibility:t}=this.config.calculators;if(!e.enabled&&!t.enabled)return"";let i="",a="";return e.enabled&&(i+=`<button class="tab-button active" data-tab="emi">${e.label}</button>`,a+=`<div class="tab-content active" id="emi">${this.renderCalculatorFields("emi",e.fields)}<div class="calculator-result" id="emi-result"></div></div>`),t.enabled&&(i+=`<button class="tab-button" data-tab="eligibility">${t.label}</button>`,a+=`<div class="tab-content" id="eligibility">${this.renderCalculatorFields("eligibility",t.fields)}<div class="calculator-result" id="eligibility-result"></div></div>`),`<div class="calculator-tabs"><div class="tab-buttons">${i}</div><div class="tab-contents">${a}</div></div>${this.renderActionButtons()}`}renderCalculatorFields(e,t){let i="<div class='calculator-fields'>";return Object.keys(t).forEach((a=>{const l=t[a];i+=`<div class="field-group"><label class="field-label">${l.label}</label><div class="field-slider-wrapper"><span class="min-value">${this.formatValue(l.min,l.suffix)}</span><input type="range" class="field-slider ${e}-${a}" data-type="${e}" data-field="${a}" min="${l.min}" max="${l.max}" step="${l.step}" value="${l.default}"><span class="max-value">${this.formatValue(l.max,l.suffix)}</span></div><div class="field-display"><span class="field-value ${e}-${a}-value">${this.formatValue(l.default,l.suffix)}</span></div></div>`})),i+"</div>"}renderActionButtons(){if(!this.config.buttons.button1.text&&!this.config.buttons.button2.text)return"";let e="<div class='calculator-actions'>";return this.config.buttons.button1.text&&(e+=`<a href="${this.config.buttons.button1.link}" class="btn btn-primary" target="_blank">${this.config.buttons.button1.text}</a>`),this.config.buttons.button2.text&&(e+=`<a href="${this.config.buttons.button2.link}" class="btn btn-secondary" target="_blank">${this.config.buttons.button2.text}</a>`),e+"</div>"}attachEventListeners(){this.block.querySelectorAll(".tab-button").forEach((e=>{e.addEventListener("click",(e=>this.switchTab(e.target.dataset.tab)))})),this.block.querySelectorAll(".employment-tab").forEach((e=>{e.addEventListener("click",(e=>this.selectEmployment(e.currentTarget.dataset.type)))})),this.block.querySelectorAll(".field-slider").forEach((e=>{e.addEventListener("input",(e=>this.onSliderChange(e.target)))}))}switchTab(e){this.block.querySelectorAll(".tab-button").forEach((t=>{t.classList.toggle("active",t.dataset.tab===e)})),this.block.querySelectorAll(".tab-content").forEach((t=>{t.classList.toggle("active",t.id===e)})),this.calculate(e)}selectEmployment(e){this.block.querySelectorAll(".employment-tab").forEach((t=>{t.classList.toggle("active",t.dataset.type===e)}))}onSliderChange(e){const t=e.dataset.type,i=e.dataset.field,a=e.value,l=this.block.querySelector(`.${t}-${i}-value`);if(l){const e="emi"===t?this.config.calculators.emi.fields:this.config.calculators.eligibility.fields;l.textContent=this.formatValue(a,e[i].suffix)}this.calculate(t)}calculate(e){"emi"===e?this.calculateEMI():"eligibility"===e&&this.calculateEligibility()}calculateEMI(){const e=parseInt(this.getSliderValue("emi","loanAmount")),t=parseInt(this.getSliderValue("emi","tenure")),i=parseFloat(this.getSliderValue("emi","rate"))/100/12,a=12*t,l=(e*i*Math.pow(1+i,a))/(Math.pow(1+i,a)-1),c=12*t*l-e;this.displayEMIResult(l,e,c,12*t*l)}calculateEligibility(){const e=parseInt(this.getSliderValue("eligibility","income")),t=parseInt(this.getSliderValue("eligibility","otherLoanEMI")),i=parseFloat(this.getSliderValue("eligibility","rate"))/100/12,a=12*parseInt(this.getSliderValue("eligibility","tenure")),l=(e-t)*.6*(i*Math.pow(1+i,a))/Math.pow(1+i,a);this.displayEligibilityResult(Math.max(0,l))}displayEMIResult(e,t,i,a){const l=this.block.querySelector("#emi-result");l&&(l.innerHTML=`<div class="result-display"><h3>Your monthly EMI is</h3><div class="result-amount">₹${Math.round(e).toLocaleString()}</div><div class="result-breakdown"><div class="breakdown-item"><span class="breakdown-label">Principal amount</span><span class="breakdown-value">₹${Math.round(t).toLocaleString()}</span></div><div class="breakdown-item"><span class="breakdown-label">Interest amount</span><span class="breakdown-value">₹${Math.round(i).toLocaleString()}</span></div><div class="breakdown-item"><span class="breakdown-label">Total amount</span><span class="breakdown-value">₹${Math.round(a).toLocaleString()}</span></div></div></div>`)}displayEligibilityResult(e){const t=this.block.querySelector("#eligibility-result");t&&(t.innerHTML=`<div class="result-display"><h3>Your home loan eligibility is</h3><div class="result-amount">₹${Math.round(e).toLocaleString()}</div><p class="result-note">Based on current income and obligations</p></div>`)}getSliderValue(e,t){const i=this.block.querySelector(`.${e}-${t}`);return i?i.value:0}formatValue(e,t){const i=parseFloat(e);let a="";if("₹"===t)return i>=1e7?a=(i/1e7).toFixed(1)+" Cr":i>=1e5?a=(i/1e5).toFixed(1)+" L":a=i.toLocaleString(),a;return"%"===t?i.toFixed(2)+"%":"Years"===t?i+" "+t:i.toString()}}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",(()=>{document.querySelectorAll(".block.generic-calculator").forEach((e=>{new GenericCalculator(e)}))})):document.querySelectorAll(".block.generic-calculator").forEach((e=>{new GenericCalculator(e)}));"undefined"!=typeof module&&module.exports&&(module.exports=GenericCalculator);
