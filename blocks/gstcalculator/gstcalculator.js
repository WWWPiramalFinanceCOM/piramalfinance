import{calculatorFlatStrLogic as S,CFApiCall as v,currenyCommaSeperation as C}from"../../scripts/scripts.js";import{homeLoanCalcFunc as q}from"../emiandeligiblitycalc/homeloancalculators.js";import{homeloanCalHTML as g}from"../homeloancalculatorv2/templatehtmlv2.js";export default async function h(t){const e=t.textContent.trim(),c=(e&&await v(e)).data,r=S(c);t.innerHTML=g(r);let s,n;try{s=document.querySelector(".home-page-calculator-call-xf"),n=s.querySelector(".cmp-container--caloverlay");const o=document.querySelector(".home-page-calculator-call-xf");document.querySelector(".home-loan-calculator-parent").classList.contains("combined-emi-eligibility")&&document.querySelector(".home-loan-calculator-parent").classList.remove("combined-emi-eligibility"),q(o),L(),T(t)}catch(o){console.warn(o)}}function L(){const t=document.querySelector(".homeloancalculator .gst");if(t){let o=function(l){const u=e.querySelector(".calctabs").children,d=Array.from(u).filter(i=>i.style.display!="none")[0],p=d.querySelector("[data-cal-result=resultAmt]");if(l==a){const{netPrice:i,gstRate:m}=y(d);n=R(i,m)}else{const{productionCost:i,gstRate:m,profitRatio:f}=y(d);n=b(i,f,m)}p.textContent=`\u20B9${C(Math.round(n))}/-`};const e=t.closest(".homeloancalculator"),a=e.querySelector(".tab-emi-calc"),c=e.querySelector(".tab-eligibility-calc"),r=e.querySelector(".gst-third-tab");r.style.display="unset",[a,c].forEach(l=>{l.addEventListener("click",()=>{r.classList.remove("active"),o(l)})});const s=e.querySelector(".headul .tab-common.active");let n=0;o(s),e.addEventListener("change",({target:l})=>{if(l.tagName=="INPUT"){const u=e.querySelector(".headul .tab-common.active");o(u)}}),r.addEventListener("click",()=>{c.click(),c.classList.remove("active"),r.classList.add("active")})}}function R(t,e){let a=t*(1+e*.01);return a=isNaN(a)?0:a,a}function b(t,e,a){let c=t*(1+e*.01)*(1+a*.01);return c=isNaN(c)?0:c,c}function y(t){const e={};return e.netPrice=t.querySelector("[data-cal-input=netprice]")?.value.replaceAll(",",""),e.productionCost=t.querySelector("[data-cal-input=productioncost]")?.value.replaceAll(",",""),e.gstRate=t.querySelector("[data-cal-input=gstrate]")?.value,e.profitRatio=t.querySelector("[data-cal-input=profitratio]")?.value,e}function T(t){if(document.querySelector(".discalimer-details").classList.remove("dp-none"),t.querySelector(".discalimer-calc")){const e=t.querySelector(".read-more-discalimer-calc"),a=t.querySelector(".disclaimer-container");e.addEventListener("click",c=>{c.target.textContent.trim()=="Read more"?(a.classList.remove("dp-none"),e.textContent="Read less"):c.target.textContent.trim()=="Read less"&&(a.classList.add("dp-none"),e.textContent="Read more")})}}
