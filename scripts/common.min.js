import{selectBranchInteraction as J}from"../dl.min.js";import{getMetadata as A}from"./aem.min.js";import{targetObject as d}from"./scripts.min.js";export function moveAttributes(e,n,t){t||(t=[...e.attributes].map(({nodeName:s})=>s)),t.forEach(s=>{const o=e.getAttribute(s);o&&(n.setAttribute(s,o),e.removeAttribute(s))})}export function renderHelper(e,n,t){const s=document.createElement("div");s.innerHTML=n;const o=s.getElementsByClassName("forName");return Array.prototype.slice.call(o).forEach(i=>{let r="";const c=i.innerHTML;for(const f in e)if(Object.hasOwnProperty.call(e,f)){const p=e[f];var a=t?t(p,f):p;const h=Object.keys(a);var u=c;u.split("{").forEach(v=>{const y=v.split("}")[0],g=y.split(".");let m=a;g.forEach(w=>{m&&m.hasOwnProperty(w)?m=m[w]:m=""}),u=u.replace(`{${y}}`,m)}),r+=u}i.outerHTML=r}),s.innerHTML}export function fetchAPI(e,n,t){return new Promise(async(s,o)=>{try{if(e==="GET"){const i=await fetch(n);s(i)}else if(e==="POST"){t.headerJson=t.headerJson||{"Content-Type":"application/json"},t.headerJson["Content-Type"]=="remove"?t.headerJson["Content-Type"]="":t.headerJson["Content-Type"]=t.headerJson["Content-Type"]?t.headerJson["Content-Type"]:"application/json";const i=new Request(n,{method:"POST",body:JSON.stringify(t.requestJson),headers:t.headerJson}),c=await(await fetch(i)).json();s({responseJson:c})}}catch(i){console.warn(i),o(i)}})}export function getProps(e,n){return Array.from(e.children).map((t,s)=>n?.picture?t.innerHTML.includes("picture")?t.querySelector("picture"):t.innerText.trim():n?.index&&n?.index.includes(s)?t:t.innerHTML.includes("picture")?t.querySelector("img").src.trim():t.innerText.trim())}export function currenyCommaSeperation(e){typeof e=="number"&&(e=e.toString());const n=e.split(".");let t=n[0];const s=n[1]?`.${n[1]}`:"";return t=t.replace(/\d(?=(\d{2})+\d$)/g,"$&,"),t+s}export function createCarousle(e,n,t){e.parentElement?e.parentElement.append(n):e.append(n),e.parentElement?e.parentElement.append(t):e.append(t),n.addEventListener("click",function(l){d.carouselButton=this,d.carouselButton.disabled=!0,T(l)}),d.carouselButton=n,t.addEventListener("click",function(l){d.carouselButton=this,d.carouselButton.disabled=!0,b(l)}),e.querySelectorAll(".carousel-item").length<4&&!d.isMobile&&(n.classList.add("dp-none"),t.classList.add("dp-none"));let s=0,o=!1,i=0,r=0,c=0;const a=e,u=e.querySelector("#carouselInner"),f=e.querySelectorAll(".carousel-item"),p=f.length;let h=$();a.addEventListener("mousedown",y),a.addEventListener("mouseup",g),a.addEventListener("mouseleave",g),a.addEventListener("mousemove",m),a.addEventListener("touchstart",y),a.addEventListener("touchend",g),a.addEventListener("touchmove",m),a.addEventListener("wheel",q);function v(){h=$(),E()}window.addEventListener("resize",()=>{d.isTab=window.matchMedia("(max-width: 1024px)").matches,v()});function y(l){o=!0,i=w(l),u.style.transition="none"}function g(){o=!1;const l=r-c;l<-100?b():l>100?T():E(),d.carouselButton.disabled=!1}function m(l){if(o){const x=w(l);r=c+x-i,u.style.transform=`translateX(${r}px)`}}function w(l){return l.type.includes("mouse")?l.pageX:l.touches[0].clientX}function $(){return d.isMobile?2:d.isTab?3:4}function L(l){l>=f.length||l<0,s=Math.max(0,Math.min(l,p-h)),E(),d.carouselButton.disabled=!1}const E=d.isTab?function(){r=s*-u.clientWidth/(e.closest(".carousel-3pt5")?2:h),c=r,u.style.transition="transform 0.5s ease",e.closest(".carousel-3pt5")&&!d.isTab&&s+4==f.length?u.style.transform=`translateX(${r-200}px)`:e.closest(".carousel-3pt5")&&d.isTab&&s?(s+4>f.length?r>-2100&&d.currentTranslate<50&&(d.currentTranslate=d.currentTranslate?d.currentTranslate+=340:40):d.currentTranslate=0,u.style.transform=`translateX(${r-d.currentTranslate}px)`):e.closest(".carousel-3pt5")&&s?u.style.transform=`translateX(${r-200}px)`:u.style.transform=`translateX(${r}px)`}:function(){r=s*-u.clientWidth/h,c=r,u.style.transition="transform 0.5s ease",e.closest(".carousel-3pt5")&&s+4==f.length?u.style.transform=`translateX(${r-200}px)`:u.style.transform=`translateX(${r}px)`};function b(l){L(s+1),S()}function T(){L(s-1),S()}function q(l){l.deltaY<0?T():b(),l.preventDefault()}L(s);function S(){const l=u.lastElementChild;new IntersectionObserver(C=>{C.forEach(M=>{M.isIntersecting?(t.classList.add("light"),t.disabled=!0):(t.disabled=!1,t.classList.remove("light"))})},{root:a}).observe(l),O()}function O(){const{firstChild:l}=u;new IntersectionObserver(C=>{C.forEach(M=>{M.isIntersecting?n.classList.add("light"):n.classList.remove("light")})},{root:a,threshold:e.closest(".carousel-3pt5")?1:.1}).observe(l)}S()}export function createButton(e,n){const t=document.createElement("button");return t.classList.add("carousel-control",e),t.innerHTML=n,t}export function decorateViewMore(e){const n=e.closest(".section");if(!n.classList.contains("view-more-btn"))return;const t=parseInt(Array.from(n.classList).find(c=>c.endsWith("-item-display"))?.replace("-item-display","")||"0"),s=e.classList.contains("columns")?e.children:e.parentElement.parentElement.children,o=(c=!1)=>{[...s].forEach((a,u)=>{a.classList.toggle("dp-none",!c&&u>=t)})};o();const i=n.querySelector(".default-content-wrapper .button-container"),r=i.querySelector("a");i.addEventListener("click",c=>{c.preventDefault();const a=r.textContent.trim().toLowerCase()==="view more";o(a),a?(r.textContent="View less",r.classList.add("view-less-more-column")):(r.textContent="View more",r.classList.remove("view-less-more-column"),P(n))})}export function decodeHtmlSymbols(e){let n=document.createElement("textarea");return n.innerHTML=e,n.value}function P(e){window.matchMedia("(max-width: 767px)").matches?window.scroll({top:e.offsetTop+20,left:0,behavior:"smooth"}):window.matchMedia("(max-width: 1024px)").matches?window.scroll({top:e.offsetTop+20,left:0,behavior:"smooth"}):window.scroll({top:e.offsetTop-30,left:0,behavior:"smooth"})}export function moveInstrumentation(e,n){moveAttributes(e,n,[...e.attributes].map(({nodeName:t})=>t).filter(t=>t.startsWith("data-aue-")||t.startsWith("data-richtext-")))}export const body=document.querySelector("body");export function showingStateCity(e){e.forEach(n=>{n.parentElement.querySelectorAll("[data-info]").forEach(t=>{t.classList.remove("dp-none")})})}export function getDay(){return["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][new Date().getDay()]}export function branchURLStr(e="",n="",t="",s,o=""){const i=f=>{let p=f.toLowerCase().trim();return p=p.replace(/\s*-\s*/g,"-").replace(/\s*\(\s*/g,"-").replace(/\s*\)\s*/g,"").replace(/\s+/g,"-"),p=p.replace(/-+/g,"-"),p.replace(/^-+|-+$/g,"")},r=i(e),c=i(n),a=i(t);return{shorthand:()=>`${A("lang-path")}/branch-locator/${a}/${c}`,shorthandstate:()=>`${A("lang-path")}/branch-locator/${a}`,loans:()=>`${A("lang-path")}/branch-locator/loans-in-`+(r===c?[c,a,o]:[r,c,a,o]).join("-")}[s]?.()}export function selectBranchDetails(e){e.closest(".section").querySelectorAll(".branch-list-wrapper a").forEach(t=>{try{t.addEventListener("click",s=>{const o={};o.cta_position=s.target.closest(".cards-branches-container ")?.querySelector(".title h2")?.textContent.trim(),o.branch_name=s.target.closest(".card-box")?.querySelector(".card-title")?.textContent.trim().replace(/\s+/g," "),J(o)})}catch(s){console.warn(s)}})}export function calculatorFlatStrLogic(e){var n={};return e.forEach(function(t){const{Fieldset:s,Name:o,Type:i,Value:r,ID:c}=t;if(s)if(n[s]||(n[s]={}),i==="loanamout"){n[s].loanamout||(n[s].loanamout=[]);let a=n[s].loanamout[c];a||(a={},n[s].loanamout[c]=a),a[o]=r}else i==="array"?n[s][o]=[]:n[s][o]=r;else n[o]=r}),n}export async function CFApiCall(e){return await(await fetchAPI("GET",e)).json()}export function groupAllKeys(e){return e.reduce((n,t)=>{for(let s in t){let o=s.toLowerCase().replace(/\s+/g,"-");n[o]||(n[o]=[]);let i="";t[s].includes("-")?i=t[s].split("-")[0].trim():i=t[s].trim(),n[o].includes(i)||n[o].push(i)}return n},{})}
