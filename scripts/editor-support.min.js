import{decorateBlock as h,decorateBlocks as w,decorateButtons as d,decorateIcons as p,decorateSections as k,loadBlock as E,loadBlocks as f}from"./aem.min.js";import{decorateRichtext as s}from"./editor-support-rte.min.js";import{decorateMain as g}from"./scripts.min.js";async function q(l){const{detail:n}=l,a=n?.request?.target?.resource||n?.request?.target?.container?.resource||n?.request?.to?.container?.resource;if(!a)return!1;const u=n?.response?.updates;if(!u.length)return!1;const{content:m}=u[0];if(!m)return!1;const i=new DOMParser().parseFromString(m,"text/html"),r=document.querySelector(`[data-aue-resource="${a}"]`);if(r){if(r.matches("main")){const t=i.querySelector(`[data-aue-resource="${a}"]`);return t.style.display="none",r.insertAdjacentElement("afterend",t),g(t),s(t),await f(t),r.remove(),t.style.display=null,y(t),!0}const c=r.parentElement?.closest(".block[data-aue-resource]")||r?.closest(".block[data-aue-resource]");if(c){const t=c.getAttribute("data-aue-resource"),e=i.querySelector(`[data-aue-resource="${t}"]`);if(e)return e.style.display="none",c.insertAdjacentElement("afterend",e),d(e),p(e),h(e),s(e),await E(e),c.remove(),e.style.display=null,!0}else{const t=i.querySelectorAll(`[data-aue-resource="${a}"],[data-richtext-resource="${a}"]`);if(t.length){const{parentElement:e}=r;if(r.matches(".section")){const[o]=t;o.style.display="none",r.insertAdjacentElement("afterend",o),d(o),p(o),s(o),k(e),w(e),await f(e),r.remove(),o.style.display=null}else r.replaceWith(...t),d(e),p(e),s(e);return!0}}}return!1}function y(l){["aue:content-patch","aue:content-update","aue:content-add","aue:content-move","aue:content-remove"].forEach(n=>l?.addEventListener(n,async a=>{a.stopPropagation(),await q(a)||window.location.reload()}))}y(document.querySelector("main"));
