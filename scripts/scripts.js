import{formOpen as D}from"../blocks/applyloanform/applyloanforms.js";import{statemasterGetStatesApi as j}from"../blocks/applyloanform/statemasterapi.js";import{validationJSFunc as N}from"../blocks/applyloanform/validation.js";import{toggleAllNavSections as F}from"../blocks/header/header.js";import{applyLoanInteraction as J,ctaClick as P,selectBranchInteraction as _}from"../dl.js";import{sampleRUM as M,loadHeader as W,loadFooter as V,decorateButtons as X,decorateIcons as z,decorateSections as R,decorateBlocks as G,decorateTemplateAndTheme as K,waitForLCP as U,loadBlocks as Y,loadCSS as g,fetchPlaceholders as Q,getMetadata as v}from"./aem.js";const Z=[];console.log("Main Branch 1.3");export function moveAttributes(e,t,n){n||(n=[...e.attributes].map(({nodeName:o})=>o)),n.forEach(o=>{const s=e.getAttribute(o);s&&(t.setAttribute(o,s),e.removeAttribute(o))})}export function createElement(e,t,n,o){const s=document.createElement(e);if(t){const r=typeof t=="string"?[t]:t;s.classList.add(...r)}if(n&&Object.keys(n).forEach(r=>{s.setAttribute(r,n[r])}),o){const r=a=>{a instanceof HTMLElement||a instanceof SVGElement?s.append(a):s.insertAdjacentHTML("beforeend",a)};Array.isArray(o)?o.forEach(r):r(o)}return s}const k=location.pathname.replace(".html","").split("/");export const targetObject={model:null,isMobile:window.matchMedia("(max-width: 767px)").matches,ctaPosition:"Top Menu Bar",ctaPosition:"Top Menu Bar",pageName:k[k.length-1]||"home-page",isTab:window.matchMedia("(max-width: 1024px)").matches};export function renderHelper(e,t,n){const o=document.createElement("div");o.innerHTML=t;const s=o.getElementsByClassName("forName");return Array.prototype.slice.call(s).forEach(r=>{let a="";const l=r.innerHTML;for(const u in e)if(Object.hasOwnProperty.call(e,u)){const p=e[u];var c=n?n(p,u):p;const m=Object.keys(c);var d=l;d.split("{").forEach(L=>{const h=L.split("}")[0],y=h.split(".");let f=c;y.forEach(w=>{f&&f.hasOwnProperty(w)?f=f[w]:f=""}),d=d.replace(`{${h}}`,f)}),a+=d}r.outerHTML=a}),o.innerHTML}export function fetchAPI(e,t,n){return new Promise(async(o,s)=>{try{if(e==="GET"){const r=await fetch(t);o(r)}else if(e==="POST"){n.headerJson=n.headerJson||{"Content-Type":"application/json"},n.headerJson["Content-Type"]=="remove"?n.headerJson["Content-Type"]="":n.headerJson["Content-Type"]=n.headerJson["Content-Type"]?n.headerJson["Content-Type"]:"application/json";const r=new Request(t,{method:"POST",body:JSON.stringify(n.requestJson),headers:n.headerJson}),l=await(await fetch(r)).json();o({responseJson:l})}}catch(r){console.warn(r),s(r)}})}function ee(e,t=""){e.querySelectorAll("a").forEach(o=>{const{href:s}=o;let r="";if(s.includes("/play.google.com-s/")?o.href=s.replace("play.google.com-s","play.google.com"):s.includes("/apps.apple.com-s/")?o.href=s.replace("apps.apple.com-s","apps.apple.com"):s.includes("play.google.com")?r="playstore":s.includes("apps.apple.com")&&(r="appstore"),r){o.textContent="";const a=document.createElement("img");a.src=`${window.hlx.codeBasePath}${t}/images/${r}.webp`,a.alt=o.title,a.loading="lazy",o.appendChild(a)}})}export function getProps(e,t){return Array.from(e.children).map((n,o)=>t?.picture?n.innerHTML.includes("picture")?n.querySelector("picture"):n.innerText.trim():t?.index&&t?.index.includes(o)?n:n.innerHTML.includes("picture")?n.querySelector("img").src.trim():n.innerText.trim())}export function currenyCommaSeperation(e){typeof e=="number"&&(e=e.toString());const t=e.split(".");let n=t[0];const o=t[1]?`.${t[1]}`:"";return n=n.replace(/\d(?=(\d{2})+\d$)/g,"$&,"),n+o}export function createCarousle(e,t,n){e.parentElement?e.parentElement.append(t):e.append(t),e.parentElement?e.parentElement.append(n):e.append(n),t.addEventListener("click",function(i){targetObject.carouselButton=this,targetObject.carouselButton.disabled=!0,E(i)}),targetObject.carouselButton=t,n.addEventListener("click",function(i){targetObject.carouselButton=this,targetObject.carouselButton.disabled=!0,x(i)}),e.querySelectorAll(".carousel-item").length<4&&!targetObject.isMobile&&(t.classList.add("dp-none"),n.classList.add("dp-none"));let o=0,s=!1,r=0,a=0,l=0;const c=e,d=e.querySelector("#carouselInner"),u=e.querySelectorAll(".carousel-item"),p=u.length;let m=$();c.addEventListener("mousedown",h),c.addEventListener("mouseup",y),c.addEventListener("mouseleave",y),c.addEventListener("mousemove",f),c.addEventListener("touchstart",h),c.addEventListener("touchend",y),c.addEventListener("touchmove",f),c.addEventListener("wheel",O);function L(){m=$(),b()}window.addEventListener("resize",()=>{targetObject.isTab=window.matchMedia("(max-width: 1024px)").matches,L()});function h(i){s=!0,r=w(i),d.style.transition="none"}function y(){s=!1;const i=a-l;i<-100?x():i>100?E():b(),targetObject.carouselButton.disabled=!1}function f(i){if(s){const T=w(i);a=l+T-r,d.style.transform=`translateX(${a}px)`}}function w(i){return i.type.includes("mouse")?i.pageX:i.touches[0].clientX}function $(){return targetObject.isMobile?2:targetObject.isTab?3:4}function S(i){i>=u.length||i<0,o=Math.max(0,Math.min(i,p-m)),b(),targetObject.carouselButton.disabled=!1}const b=targetObject.isTab?function(){a=o*-d.clientWidth/(e.closest(".carousel-3pt5")?2:m),l=a,d.style.transition="transform 0.5s ease",e.closest(".carousel-3pt5")&&!targetObject.isTab&&o+4==u.length?d.style.transform=`translateX(${a-200}px)`:e.closest(".carousel-3pt5")&&targetObject.isTab&&o?(o+4>u.length?a>-2100&&targetObject.currentTranslate<50&&(targetObject.currentTranslate=targetObject.currentTranslate?targetObject.currentTranslate+=340:40):targetObject.currentTranslate=0,d.style.transform=`translateX(${a-targetObject.currentTranslate}px)`):e.closest(".carousel-3pt5")&&o?d.style.transform=`translateX(${a-200}px)`:d.style.transform=`translateX(${a}px)`}:function(){a=o*-d.clientWidth/m,l=a,d.style.transition="transform 0.5s ease",e.closest(".carousel-3pt5")&&o+4==u.length?d.style.transform=`translateX(${a-200}px)`:d.style.transform=`translateX(${a}px)`};function x(i){S(o+1),C()}function E(){S(o-1),C()}function O(i){i.deltaY<0?E():x(),i.preventDefault()}S(o);function C(){const i=d.lastElementChild;new IntersectionObserver(A=>{A.forEach(q=>{q.isIntersecting?(n.classList.add("light"),n.disabled=!0):(n.disabled=!1,n.classList.remove("light"))})},{root:c}).observe(i),H()}function H(){const{firstChild:i}=d;new IntersectionObserver(A=>{A.forEach(q=>{q.isIntersecting?t.classList.add("light"):t.classList.remove("light")})},{root:c,threshold:e.closest(".carousel-3pt5")?1:.1}).observe(i)}C()}window.addEventListener("resize",()=>{targetObject.isTab=window.matchMedia("(max-width: 1024px)").matches});export function createButton(e,t){const n=document.createElement("button");return n.classList.add("carousel-control",e),n.innerHTML=t,n}export async function decoratePlaceholder(e,t){try{const n=await Q(t);return e.querySelectorAll("*").forEach((o,s)=>{o.firstChild instanceof Text&&Object.keys(n).forEach(r=>{var a=n[r];a&&a.trim()&&o.firstChild.textContent.trim()&&o.firstChild.textContent.includes(`{${r}}`)&&(console.log(o.innerHTML," :: ",o.firstChild.textContent),o.innerHTML=o.firstChild.textContent.replaceAll(`{${r}}`,a))})}),e.innerHTML}catch(n){console.warn(n)}}export function decorateViewMore(e){const t=e.closest(".section");if(!t.classList.contains("view-more-btn"))return;const n=parseInt(Array.from(t.classList).find(l=>l.endsWith("-item-display"))?.replace("-item-display","")||"0"),o=e.classList.contains("columns")?e.children:e.parentElement.parentElement.children,s=(l=!1)=>{[...o].forEach((c,d)=>{c.classList.toggle("dp-none",!l&&d>=n)})};s();const r=t.querySelector(".default-content-wrapper .button-container"),a=r.querySelector("a");r.addEventListener("click",l=>{l.preventDefault();const c=a.textContent.trim().toLowerCase()==="view more";s(c),c?(a.textContent="View less",a.classList.add("view-less-more-column")):(a.textContent="View more",a.classList.remove("view-less-more-column"),te(t))})}export async function decorateAnchorTag(e){try{e.querySelectorAll("a").forEach(t=>{const n=document.body;xe(t,n)})}catch(t){console.warn(t)}}export function decodeHtmlSymbols(e){let t=document.createElement("textarea");return t.innerHTML=e,t.value}function te(e){window.matchMedia("(max-width: 767px)").matches?window.scroll({top:e.offsetTop+20,left:0,behavior:"smooth"}):window.matchMedia("(max-width: 1024px)").matches?window.scroll({top:e.offsetTop+20,left:0,behavior:"smooth"}):window.scroll({top:e.offsetTop-30,left:0,behavior:"smooth"})}export function moveInstrumentation(e,t){moveAttributes(e,t,[...e.attributes].map(({nodeName:n})=>n).filter(n=>n.startsWith("data-aue-")||n.startsWith("data-richtext-")))}async function I(){await g(`${window.hlx.codeBasePath}/styles/fonts.css`);try{window.location.hostname.includes("localhost")||sessionStorage.setItem("fonts-loaded","true")}catch{}}function ne(e){e.addEventListener("click",async t=>{const n=t.target.closest("a");if(n&&n.href&&n.href.includes("/modals/")){t.preventDefault();const{openModal:o}=await import(`${window.hlx.codeBasePath}/blocks/modal/modal.js`);o(n.href)}})}function Ie(){}export async function decorateMain(e){decorateAnchorTag(e),decoratePlaceholder(e),X(e),z(e),R(e),G(e),ee(e),handleOpenFormOnClick(e),handleReadAll(e)}async function oe(e){document.documentElement.lang="en",K();const t=e.querySelector("main");t&&(decorateMain(t),document.body.classList.add("appear"),await U(Z));try{(window.innerWidth>=900||sessionStorage.getItem("fonts-loaded"))&&I()}catch{}}async function se(e){ne(e);const t=v("template");t&&await ae(e,t);const n=e.querySelector("main");await Y(n);const{hash:o}=window.location,s=o?e.getElementById(o.substring(1)):!1;o&&s&&s.scrollIntoView(),W(e.querySelector("header")),V(e.querySelector("footer")),g(`${window.hlx.codeBasePath}/styles/lazy-styles.css`),I(),M("lazy"),M.observe(n.querySelectorAll("div[data-block-name]")),M.observe(n.querySelectorAll("picture > img"))}function re(){window.setTimeout(()=>import("./delayed.js"),3e3),import("./sidekick.js").then(({initSidekick:e})=>e())}async function ae(e,t){try{const n=new Promise(s=>{g(`${window.hlx.codeBasePath}/templates/${t}/${t}.css`,s)}),o=new Promise(s=>{(async()=>{try{const r=await import(`../templates/${t}/${t}.js`);r.default&&await r.default(e)}catch(r){console.log(`failed to load module for ${t}`,r)}s()})()});await Promise.all([n,o])}catch(n){console.log(`failed to load block ${t}`,n)}}async function ce(){await ie(),await oe(document),await se(document),re()}ce();async function ie(){[`${window.hlx.codeBasePath}/styles/common/common.css`,`${window.hlx.codeBasePath}/styles/reset.css`].forEach(async t=>{await g(t)})}export const body=document.querySelector("body");body?.addEventListener("click",e=>{const t=e.target,n=document.querySelector(".loan-form-sub-parent"),o=document.querySelector(".modal-overlay");try{le(t,n,o),de(t),ue(t),pe(t),fe(t),me(t),he(t)}catch(s){console.warn(s)}});function le(e,t,n){!e.closest(".show")&&targetObject.model&&t?.style.visibility!=="visible"&&(targetObject.model?.querySelector(".overlayDiv").classList.remove("show"),document.body.style.overflow="scroll",ye(n),we(t))}function de(e){if(!e.closest(".nav-drop")){const n=document.getElementById("nav").querySelector(".nav-sections");ge(n)}}function ue(e){e.classList.contains("overlay")&&targetObject.models?.forEach(t=>{t.classList.add("dp-none"),t.classList.remove("overlay")})}function pe(e){if(!e.closest(".stake-pop-up")){if(!document.querySelector(".stake-pop-up")?.length>0)return!1;document.querySelector(".partnership-tab-content.partnership-image-popup .cmp-text.active")?.classList.remove("active"),ve()}}function fe(e){document.querySelector(".neeyat-header")&&!e.closest(".inner-lang-switch")&&document.querySelector(".maindiv-lang-switch ul")?.classList.add("dp-none")}function me(e){document.querySelector(".branch-locater-banner")&&!e.classList.contains("search-input")&&(!e.closest(".default-state-selected")||!e.closest(".default-city-selected"))&&Le()}function he(e){if(!e.closest(".toggleCityContainer")&&!e.closest(".select-container")&&!e.closest("fieldset")&&!e.closest("cityBlack")){const t=document.querySelector(".select-container"),n=document.querySelector(".cities-container");t?.classList.contains("open")&&t&&n&&(n.style.display="none",t.classList.remove("open"))}}function ye(e){e.classList.remove("overlay"),e.classList.add("dp-none"),e.style.zIndex="revert-layer"}function we(e){if(e){const t=document.createElement("li");t.textContent="No options",t.classList.add("orangepoints"),e.querySelector("#branchcontainer ul").innerHTML=t.outerHTML}}function ge(e){e?.children[0]?.classList.remove("active"),e?.querySelectorAll(":scope .default-content-wrapper > ul > li").forEach(t=>{F(e),t.setAttribute("aria-expanded","false"),e.setAttribute("aria-expanded","false"),document.body.classList.contains("modal-open")&&t.getAttribute("aria-expanded")==="false"&&document.body.classList.remove("modal-open")})}function ve(){document.querySelectorAll(".stake-pop-up").forEach(e=>{e.classList.remove("dp-block"),e.classList.add("dp-none")}),document.body.style.overflow="auto",document.querySelector(".modal-overlay").classList.remove("overlay"),document.querySelector(".modal-overlay").classList.add("dp-none")}function Le(){const e=document.querySelectorAll(".search-input");showingStateCity(e),document.querySelector(".state-wrapper").classList.add("dp-none"),document.querySelector(".city-wrapper").classList.add("dp-none"),document.querySelector(".state-wrapper > input").value="",document.querySelector(".city-wrapper > input").value=""}export function showingStateCity(e){e.forEach(t=>{t.parentElement.querySelectorAll("[data-info]").forEach(n=>{n.classList.remove("dp-none")})})}export function handleReadAll(e){try{e.querySelector(".section.carousel-articles-wrapper").querySelector(".default-content-wrapper p a").addEventListener("click",Se)}catch{}}function Se(e){try{if(e.target.closest(".section.read-all-dl")){const t=e.target.textContent.trim(),n=e.target.closest(".section").querySelector(".default-content-wrapper").querySelector("h1, h2, h3, h4, h5, h6").textContent.trim();P(t,"",n,targetObject.pageName)}}catch{console.log("read all not found Analytics")}}export function handleOpenFormOnClick(e){e.querySelectorAll(".open-form-on-click .button-container").forEach(n=>{console.log(n),n.addEventListener("click",B)})}function Be(e){if(!e)return;const t=be(e);e.querySelectorAll(".block.carousel-item").forEach(o=>{const s=o.querySelectorAll(".button-container")[t];s&&s.addEventListener("click",B)})}function be(e){return Array.from(e.classList).find(t=>t.startsWith("neeyat-button-"))?.replace("neeyat-button-","")||0}function B(e){j(),N(),D();try{if(!e.target.closest(".section").classList.contains("banner-carousel-wrapper")&&!e.target.closest(".section").classList.contains("documents-required-brown")){const t={};t.click_text=e.target.textContent.trim(),J(t)}if(e.target.closest(".section").classList.contains("documents-required-brown")){const t=e.target.textContent.trim(),n=e.target.closest(".section").querySelector(".default-content-wrapper").querySelector("h1, h2, h3, h4, h5, h6").textContent.trim();P(t,n,"",targetObject.pageName)}}catch(t){console.warn(t)}e.preventDefault()}export function getDay(){return["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][new Date().getDay()]}export function branchURLStr(e="",t="",n="",o,s=""){const r=u=>{let p=u.toLowerCase().trim();return p=p.replace(/\s*-\s*/g,"-").replace(/\s*\(\s*/g,"-").replace(/\s*\)\s*/g,"").replace(/\s+/g,"-"),p=p.replace(/-+/g,"-"),p.replace(/^-+|-+$/g,"")},a=r(e),l=r(t),c=r(n);return{shorthand:()=>`${v("primary-language-path")}/branch-locator/${c}/${l}`,shorthandstate:()=>`${v("primary-language-path")}/branch-locator/${c}`,loans:()=>`${v("primary-language-path")}/branch-locator/loans-in-`+(a===l?[l,c,s]:[a,l,c,s]).join("-")}[o]?.()}export function selectBranchDetails(e){e.closest(".section").querySelectorAll(".branch-list-wrapper a").forEach(n=>{try{n.addEventListener("click",o=>{const s={};s.cta_position=o.target.closest(".cards-branches-container ")?.querySelector(".title h2")?.textContent.trim(),s.branch_name=o.target.closest(".card-box")?.querySelector(".card-title")?.textContent.trim().replace(/\s+/g," "),_(s)})}catch(o){console.warn(o)}})}export function calculatorFlatStrLogic(e){var t={};return e.forEach(function(n){const{Fieldset:o,Name:s,Type:r,Value:a,ID:l}=n;if(o)if(t[o]||(t[o]={}),r==="loanamout"){t[o].loanamout||(t[o].loanamout=[]);let c=t[o].loanamout[l];c||(c={},t[o].loanamout[l]=c),c[s]=a}else r==="array"?t[o][s]=[]:t[o][s]=a;else t[s]=a}),t}export async function CFApiCall(e){return await(await fetchAPI("GET",e)).json()}export function groupAllKeys(e){return e.reduce((t,n)=>{for(let o in n){let s=o.toLowerCase().replace(/\s+/g,"-");t[s]||(t[s]=[]);let r="";n[o].includes("-")?r=n[o].split("-")[0].trim():r=n[o].trim(),t[s].includes(r)||t[s].push(r)}return t},{})}const xe=(e,t)=>{e.innerHTML.includes("<sub>")&&(e.target="_blank"),e.href.includes("/modal-popup/")&&Ee(e,t)},Ee=(e,t)=>{const n=e.href.split("/").pop();e.dataset.modelId=n,targetObject.modelId=n,e.dataset.href=e.href,e.href="javascript:void(0)",e.addEventListener("click",o=>{o.preventDefault();const s=document.querySelectorAll(`.${n}`);targetObject.models=s,s.length&&(s.forEach(r=>{r.classList.add("dp-none"),r.remove(),t.prepend(r),r.classList.remove("dp-none"),r.classList.add("overlay");const a=r.querySelector("em");a?.innerHTML.includes(":cross-icon")&&(a.innerHTML="",a.addEventListener("click",()=>{r.classList.remove("overlay"),r.classList.add("dp-none")}))}),t.style.overflow="hidden")})};
